# CodeDocGen Frontend

This project is the frontend for the Code Documentation Generator, built with React and Material UI.

## Prerequisites

- Node.js (v18 or later recommended)
- npm or yarn

## Setup

1.  **Clone the repository (if you haven't already for the backend).**
2.  **Navigate to the `codedocgen-frontend` directory:**
    ```bash
    cd codedocgen-frontend
    ```
3.  **Install dependencies:**
    Using npm:
    ```bash
    npm install
    ```
    Or using yarn:
    ```bash
    yarn install
    ```
4.  **Environment Variables (Recommended):**
    Create a `.env` file in the `codedocgen-frontend` root directory with:
    ```
    REACT_APP_API_URL=http://localhost:8080/api
    REACT_APP_BACKEND_STATIC_URL=http://localhost:8080
    ```
    Defaults are provided if `.env` is not used.

## Available Scripts

In the project directory, you can run:

### `npm start` or `yarn start`

Runs the app in development mode.
Open [http://localhost:3000](http://localhost:3000) to view it in your browser.

The page will reload when you make changes.
You may also see any lint errors in the console.

The backend server (codedocgen-backend) must be running for the API calls to work and diagrams to be served.

### `npm test` or `yarn test`

Launches the test runner in interactive watch mode.

### `npm run build` or `yarn build`

Builds the app for production to the `build` folder.
It correctly bundles React in production mode and optimizes the build for the best performance.

The build is minified and the filenames include the hashes.
Your app is ready to be deployed!

### `npm run eject`

**Note: this is a one-way operation. Once you `eject`, you can't go back!**

If you aren't satisfied with the build tool and configuration choices, you can `eject` at any time. This command will remove the single build dependency from your project.

Instead, it will copy all the configuration files and the transitive dependencies (webpack, Babel, ESLint, etc.) right into your project so you have full control over them. All of the commands except `eject` will still work, but they will point to the copied scripts so you can tweak them. At this point, you're on your own.

## Features

- Input a Git repository URL for analysis.
- View a project overview including name, type, and detected Spring Boot version.
- Browse detailed metadata for classes, interfaces, enums, and annotations.
- View extracted REST API endpoints.
- Display various generated PlantUML diagrams with zoom/pan capabilities:
    - Class Diagram
    - Component Diagram
    - Usecase Diagram
    - Entity-Relationship Diagram (ERD)
    - Database Schema Diagram
- **Call Flow Analysis (`CallFlowPage.js`):**
    - View generated Sequence Diagrams for key controller/service entry points.
    - See raw, step-by-step call flows associated with each sequence diagram, explorable via `FlowExplorer.tsx`.
    - **Displays user-friendly names for flows and diagrams, generated by parsing full Java method signatures (including parameter types and names) using the `generateFlowDisplayName` helper function.**
- **Database Analysis (Enhanced):**
    - View a database schema diagram.
    - **Display an "Entities and Interacting DAO/Repository Classes" section, showing which DAOs/Repositories operate on each detected Entity (uses `analysisResult.dbAnalysis.classesByEntity`).**
    - **Display a "Detailed Operations by DAO/Repository Class" table, listing specific SQL operations (including method name, type, tables, and query) for each class (uses `analysisResult.dbAnalysis.operationsByClass`).**
- **Logger Insights Page (`LoggerInsightsPage.js`):**
    - Displays a filterable and sortable table of all detected logging statements from the analyzed project.
    - Shows class name, line number, log level, the log message content, and extracted variables.
    - Clearly flags potential **PII (Personally Identifiable Information)** and **PCI (Payment Card Industry)** risks based on backend analysis (which uses comprehensive keyword patterns).
    - Allows users to filter logs by PII risk, PCI risk, log level, and search terms within class names or messages.
    - Provides an option to download the filtered list of logs as a PDF report.
- View OpenAPI/Swagger UI if an OpenAPI specification is generated by the backend.
- Display Gherkin feature files if present in the analyzed project.
- View parse warnings if some files encounter issues during backend analysis.

## Further Enhancements (TODO - Frontend Specific)

- More detailed display for SOAP services (WSDL/XSD views are present, but could be more interactive).
- Enhanced error handling and user feedback.
- More sophisticated UI for complex metadata (e.g., filtering, searching, pagination for large datasets).
- Options to trigger re-analysis or clear results.
- Dark mode theme.
- **`ApiSpecsPage.js`**: (WSDL/XSD rendering) Future enhancement - if `typeAttr` refers to a global `complexType`, expand it (acknowledged as complex, detailed in spec).

## Run Locally
```bash
npm install
npm start
```

## Uses
- React + TypeScript
- Material UI (primary styling) with potential for Tailwind CSS + shadcn/ui elements as per `package.json`.
- Axios for backend integration

## Recent Updates (Reflecting Backend & Frontend Sync)
- **Major Backend Overhaul for Accuracy:**
    - Implemented robust Java symbol resolution, significantly improving method call detection, type resolution, and overall code understanding.
    - Enhanced `CallFlowAnalyzer` to produce more accurate sequence diagrams and raw call steps.
    - Refined class type determination and DAO analysis.
- **Frontend Diagram & Call Flow Improvements:**
    - **`CallFlowPage.js` now features significantly improved display names for sequence diagrams and call flow details. The `generateFlowDisplayName` function robustly parses full Java method signatures, including parameter types and names, to create human-readable titles, resolving previous issues with long or unparsed names.**
    - `FlowExplorer.tsx` component integrated into `CallFlowPage.js` for better navigation of call steps (expand/collapse functionality).
    - Ensured all diagram types (Class, Component, Usecase, Sequence, ERD, DB Schema) are rendered correctly.
    - Spring Boot version display on the Overview page is accurate.
- **General Stability:**
    - Addressed various bugs related to diagram loading, data passing, and backend parsing errors.
    - JavaParser backend upgraded for Java 7-21 compatibility.
    - Improved logging in the backend.
- **Frontend Database Page Enhancements:**
    - **Consumes the new `dbAnalysis` object from the backend.**
    - **Renders an entity-centric view and a detailed table of database operations per DAO/Repository.**
- **Logger Insights Page:**
    - UI is implemented to display PII/PCI risks separately.
    - Filtering and PDF export functionality are in place.
- **General Stability & Display Improvements:**
    - Call Flow page correctly displays sequence diagrams and raw steps with improved naming.
    - All diagram types are rendered correctly.
    - Accurate Spring Boot version display.
    - Addressed various bugs in data passing and display.
    - Backend compilation issues related to CXF JAX-RS and Swagger resolved, ensuring more stable data for frontend consumption. 